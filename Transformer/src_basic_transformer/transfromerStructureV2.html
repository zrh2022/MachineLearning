<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TransformerÊû∂ÊûÑÂõæ - ËØ¶ÁªÜËÆ°ÁÆóËøáÁ®ã</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: bold;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-style: italic;
        }

        .legend {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
        }

        .legend h3 {
            color: #2c3e50;
            margin-top: 0;
        }

        .legend-item {
            display: inline-block;
            margin: 5px 15px 5px 0;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .tensor-shape { background: #e8f4f8; color: #2980b9; }
        .operation { background: #e8f8f5; color: #27ae60; }

        .architecture-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-top: 30px;
        }

        .encoder-section, .decoder-section {
            flex: 1;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            position: relative;
        }

        .section-title {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        .layer-stack {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .transformer-layer {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .transformer-layer:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
            border-color: #3498db;
        }

        .layer-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.1em;
        }

        .sublayer {
            background: #f1f2f6;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            position: relative;
        }

        .sublayer-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .computation-flow {
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 0.8em;
        }

        .computation-step {
            background: white;
            border-radius: 6px;
            padding: 8px 10px;
            border: 1px solid #ddd;
            position: relative;
        }

        .formula {
            font-family: 'Courier New', monospace;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 4px 8px;
            border-radius: 4px;
            margin: 4px 0;
            font-weight: bold;
            font-size: 0.85em;
        }

        .tensor-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            margin-top: 5px;
            font-size: 0.75em;
        }

        .tensor-var {
            background: #3498db;
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
            text-align: center;
        }

        .tensor-shape-info {
            background: #e74c3c;
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
            text-align: center;
        }

        .input-step { border-left: 4px solid #3498db; }
        .attention-step { border-left: 4px solid #e74c3c; }
        .ffn-step { border-left: 4px solid #27ae60; }
        .output-step { border-left: 4px solid #9b59b6; }

        .arrow {
            text-align: center;
            font-size: 1.2em;
            color: #7f8c8d;
            margin: 3px 0;
        }

        .input-embedding, .output-embedding {
            background: #e8f4f8;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #3498db;
        }

        .nx-label {
            position: absolute;
            left: -15px;
            top: 50%;
            transform: translateY(-50%);
            background: #e74c3c;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .cross-attention {
            position: relative;
            border: 2px dashed #f39c12;
        }

        .cross-attention::before {
            content: "Êù•Ëá™ÁºñÁ†ÅÂô®ËæìÂá∫";
            position: absolute;
            right: -90px;
            top: 10px;
            background: #f39c12;
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.7em;
            white-space: nowrap;
        }

        .matrix-mult {
            background: #8e44ad;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            margin: 0 3px;
        }

        .softmax-op {
            background: #e67e22;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            margin: 0 3px;
        }

        .relu-op {
            background: #27ae60;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            margin: 0 3px;
        }

        .layernorm-op {
            background: #34495e;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            margin: 0 3px;
        }

        @media (max-width: 1200px) {
            .architecture-container {
                flex-direction: column;
            }

            .cross-attention::before {
                position: relative;
                right: auto;
                top: auto;
                display: block;
                margin-bottom: 8px;
            }
        }

        .note-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .note-box h4 {
            margin-top: 0;
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî• TransformerÊû∂ÊûÑÂõæ</h1>
        <div class="subtitle">ËØ¶ÁªÜËÆ°ÁÆóËøáÁ®ã‰∏éÂº†ÈáèÂΩ¢Áä∂ - "Attention is All You Need"</div>

        <div class="legend">
            <h3>üìã Á¨¶Âè∑ËØ¥Êòé</h3>
            <div class="legend-item tensor-shape">B = batch_size</div>
            <div class="legend-item tensor-shape">S_src = Ê∫êÂ∫èÂàóÈïøÂ∫¶</div>
            <div class="legend-item tensor-shape">S_tgt = ÁõÆÊ†áÂ∫èÂàóÈïøÂ∫¶</div>
            <div class="legend-item tensor-shape">d_model = 512</div>
            <div class="legend-item tensor-shape">h = 8 (Ê≥®ÊÑèÂäõÂ§¥Êï∞)</div>
            <div class="legend-item tensor-shape">d_k = d_v = 64</div>
            <div class="legend-item tensor-shape">d_ff = 2048</div>
            <div class="legend-item tensor-shape">V = ËØçÊ±áË°®Â§ßÂ∞è</div>
        </div>

        <div class="architecture-container">
            <!-- ÁºñÁ†ÅÂô®ÈÉ®ÂàÜ -->
            <div class="encoder-section">
                <div class="section-title">üî¢ ÁºñÁ†ÅÂô® (Encoder)</div>

                <div class="input-embedding">
                    <div class="sublayer-title">üìù ËæìÂÖ•Â§ÑÁêÜ</div>
                    <div class="computation-flow">
                        <div class="computation-step input-step">
                            <div class="formula">ËæìÂÖ•: tokens</div>
                            <div class="tensor-info">
                                <div class="tensor-var">tokens</div>
                                <div class="tensor-shape-info">[B, S_src]</div>
                            </div>
                        </div>

                        <div class="arrow">‚Üì</div>

                        <div class="computation-step input-step">
                            <div class="formula">embed = E[tokens] √ó ‚àöd_model</div>
                            <div class="tensor-info">
                                <div class="tensor-var">E</div>
                                <div class="tensor-shape-info">[V, d_model]</div>
                                <div class="tensor-var">embed</div>
                                <div class="tensor-shape-info">[B, S_src, d_model]</div>
                            </div>
                        </div>

                        <div class="arrow">+</div>

                        <div class="computation-step input-step">
                            <div class="formula">PE(pos,2i) = sin(pos/10000^(2i/d_model))</div>
                            <div class="formula">PE(pos,2i+1) = cos(pos/10000^(2i/d_model))</div>
                            <div class="tensor-info">
                                <div class="tensor-var">PE</div>
                                <div class="tensor-shape-info">[1, S_src, d_model]</div>
                            </div>
                        </div>

                        <div class="arrow">‚Üì</div>

                        <div class="computation-step input-step">
                            <div class="formula">X = embed + PE</div>
                            <div class="tensor-info">
                                <div class="tensor-var">X</div>
                                <div class="tensor-shape-info">[B, S_src, d_model]</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layer-stack">
                    <div class="transformer-layer">
                        <div class="nx-label">N√ó6</div>
                        <div class="layer-name">üèóÔ∏è ÁºñÁ†ÅÂô®Â±Ç</div>

                        <div class="sublayer">
                            <div class="sublayer-title">üîÑ Â§öÂ§¥Ëá™Ê≥®ÊÑèÂäõ</div>
                            <div class="computation-flow">
                                <div class="computation-step attention-step">
                                    <div class="formula">Q = X √ó W_Q, K = X √ó W_K, V = X √ó W_V</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">X</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                        <div class="tensor-var">W_Q,W_K,W_V</div>
                                        <div class="tensor-shape-info">[d_model, d_model]</div>
                                        <div class="tensor-var">Q,K,V</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">Q,K,V ‚Üí reshape ‚Üí [B, S_src, h, d_k] ‚Üí transpose ‚Üí [B, h, S_src, d_k]</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Q,K,V (multi-head)</div>
                                        <div class="tensor-shape-info">[B, h, S_src, d_k]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">scores = (Q √ó K^T) / ‚àöd_k</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Q</div>
                                        <div class="tensor-shape-info">[B, h, S_src, d_k]</div>
                                        <div class="tensor-var">K^T</div>
                                        <div class="tensor-shape-info">[B, h, d_k, S_src]</div>
                                        <div class="tensor-var">scores</div>
                                        <div class="tensor-shape-info">[B, h, S_src, S_src]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">attn_weights = <span class="softmax-op">Softmax</span>(scores)</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">attn_weights</div>
                                        <div class="tensor-shape-info">[B, h, S_src, S_src]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">head_out = attn_weights √ó V</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">attn_weights</div>
                                        <div class="tensor-shape-info">[B, h, S_src, S_src]</div>
                                        <div class="tensor-var">V</div>
                                        <div class="tensor-shape-info">[B, h, S_src, d_k]</div>
                                        <div class="tensor-var">head_out</div>
                                        <div class="tensor-shape-info">[B, h, S_src, d_k]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">concat_out = Concat(head_out) √ó W_O</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">concat_out</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                        <div class="tensor-var">W_O</div>
                                        <div class="tensor-shape-info">[d_model, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="sublayer">
                            <div class="sublayer-title">‚ö° Add & Norm</div>
                            <div class="computation-flow">
                                <div class="computation-step output-step">
                                    <div class="formula">X‚ÇÅ = <span class="layernorm-op">LayerNorm</span>(X + concat_out)</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">X‚ÇÅ</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="sublayer">
                            <div class="sublayer-title">üß† ÂâçÈ¶àÁΩëÁªú</div>
                            <div class="computation-flow">
                                <div class="computation-step ffn-step">
                                    <div class="formula">hidden = <span class="relu-op">ReLU</span>(X‚ÇÅ √ó W‚ÇÅ + b‚ÇÅ)</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">X‚ÇÅ</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                        <div class="tensor-var">W‚ÇÅ</div>
                                        <div class="tensor-shape-info">[d_model, d_ff]</div>
                                        <div class="tensor-var">b‚ÇÅ</div>
                                        <div class="tensor-shape-info">[d_ff]</div>
                                        <div class="tensor-var">hidden</div>
                                        <div class="tensor-shape-info">[B, S_src, d_ff]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step ffn-step">
                                    <div class="formula">ffn_out = hidden √ó W‚ÇÇ + b‚ÇÇ</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">W‚ÇÇ</div>
                                        <div class="tensor-shape-info">[d_ff, d_model]</div>
                                        <div class="tensor-var">b‚ÇÇ</div>
                                        <div class="tensor-shape-info">[d_model]</div>
                                        <div class="tensor-var">ffn_out</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="sublayer">
                            <div class="sublayer-title">‚ö° Add & Norm</div>
                            <div class="computation-flow">
                                <div class="computation-step output-step">
                                    <div class="formula">X‚ÇÇ = <span class="layernorm-op">LayerNorm</span>(X‚ÇÅ + ffn_out)</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">X‚ÇÇ</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="input-embedding">
                    <div class="sublayer-title">üì§ ÁºñÁ†ÅÂô®ËæìÂá∫</div>
                    <div class="computation-flow">
                        <div class="computation-step output-step">
                            <div class="formula">Memory = X‚ÇÇ (ÊúÄÁªàÁºñÁ†ÅÂô®Â±ÇËæìÂá∫)</div>
                            <div class="tensor-info">
                                <div class="tensor-var">Memory</div>
                                <div class="tensor-shape-info">[B, S_src, d_model]</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ëß£Á†ÅÂô®ÈÉ®ÂàÜ -->
            <div class="decoder-section">
                <div class="section-title">üéØ Ëß£Á†ÅÂô® (Decoder)</div>

                <div class="output-embedding">
                    <div class="sublayer-title">üìù ËæìÂá∫Â§ÑÁêÜ</div>
                    <div class="computation-flow">
                        <div class="computation-step input-step">
                            <div class="formula">ËæìÂÖ•: tgt_tokens (Âè≥Áßª)</div>
                            <div class="tensor-info">
                                <div class="tensor-var">tgt_tokens</div>
                                <div class="tensor-shape-info">[B, S_tgt]</div>
                            </div>
                        </div>

                        <div class="arrow">‚Üì</div>

                        <div class="computation-step input-step">
                            <div class="formula">tgt_embed = E[tgt_tokens] √ó ‚àöd_model</div>
                            <div class="tensor-info">
                                <div class="tensor-var">E</div>
                                <div class="tensor-shape-info">[V, d_model]</div>
                                <div class="tensor-var">tgt_embed</div>
                                <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                            </div>
                        </div>

                        <div class="arrow">+</div>

                        <div class="computation-step input-step">
                            <div class="formula">Y = tgt_embed + PE</div>
                            <div class="tensor-info">
                                <div class="tensor-var">Y</div>
                                <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layer-stack">
                    <div class="transformer-layer">
                        <div class="nx-label">N√ó6</div>
                        <div class="layer-name">üèóÔ∏è Ëß£Á†ÅÂô®Â±Ç</div>

                        <div class="sublayer">
                            <div class="sublayer-title">üîí Êé©Á†ÅÂ§öÂ§¥Ëá™Ê≥®ÊÑèÂäõ</div>
                            <div class="computation-flow">
                                <div class="computation-step attention-step">
                                    <div class="formula">Q = Y √ó W_Q, K = Y √ó W_K, V = Y √ó W_V</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Q,K,V</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">Q,K,V ‚Üí [B, h, S_tgt, d_k]</div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">scores = (Q √ó K^T) / ‚àöd_k + mask</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">mask</div>
                                        <div class="tensor-shape-info">[S_tgt, S_tgt] (‰∏ã‰∏âËßí)</div>
                                        <div class="tensor-var">scores</div>
                                        <div class="tensor-shape-info">[B, h, S_tgt, S_tgt]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">masked_attn_out = <span class="softmax-op">Softmax</span>(scores) √ó V</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">masked_attn_out</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="sublayer">
                            <div class="sublayer-title">‚ö° Add & Norm</div>
                            <div class="computation-flow">
                                <div class="computation-step output-step">
                                    <div class="formula">Y‚ÇÅ = <span class="layernorm-op">LayerNorm</span>(Y + masked_attn_out)</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Y‚ÇÅ</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="sublayer cross-attention">
                            <div class="sublayer-title">üîÑ ÁºñÁ†ÅÂô®-Ëß£Á†ÅÂô®Ê≥®ÊÑèÂäõ</div>
                            <div class="computation-flow">
                                <div class="computation-step attention-step">
                                    <div class="formula">Q = Y‚ÇÅ √ó W_Q</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Q</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                    </div>
                                </div>

                                <div class="computation-step attention-step">
                                    <div class="formula">K = Memory √ó W_K, V = Memory √ó W_V</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Memory</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                        <div class="tensor-var">K,V</div>
                                        <div class="tensor-shape-info">[B, S_src, d_model]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">Q ‚Üí [B, h, S_tgt, d_k], K,V ‚Üí [B, h, S_src, d_k]</div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">cross_scores = (Q √ó K^T) / ‚àöd_k</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">cross_scores</div>
                                        <div class="tensor-shape-info">[B, h, S_tgt, S_src]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step attention-step">
                                    <div class="formula">cross_attn_out = <span class="softmax-op">Softmax</span>(cross_scores) √ó V</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">cross_attn_out</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="sublayer">
                            <div class="sublayer-title">‚ö° Add & Norm</div>
                            <div class="computation-flow">
                                <div class="computation-step output-step">
                                    <div class="formula">Y‚ÇÇ = <span class="layernorm-op">LayerNorm</span>(Y‚ÇÅ + cross_attn_out)</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Y‚ÇÇ</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="sublayer">
                            <div class="sublayer-title">üß† ÂâçÈ¶àÁΩëÁªú</div>
                            <div class="computation-flow">
                                <div class="computation-step ffn-step">
                                    <div class="formula">hidden = <span class="relu-op">ReLU</span>(Y‚ÇÇ √ó W‚ÇÅ + b‚ÇÅ)</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Y‚ÇÇ</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                        <div class="tensor-var">W‚ÇÅ</div>
                                        <div class="tensor-shape-info">[d_model, d_ff]</div>
                                        <div class="tensor-var">hidden</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_ff]</div>
                                    </div>
                                </div>

                                <div class="arrow">‚Üì</div>

                                <div class="computation-step ffn-step">
                                    <div class="formula">ffn_out = hidden √ó W‚ÇÇ + b‚ÇÇ</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">W‚ÇÇ</div>
                                        <div class="tensor-shape-info">[d_ff, d_model]</div>
                                        <div class="tensor-var">ffn_out</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="sublayer">
                            <div class="sublayer-title">‚ö° Add & Norm</div>
                            <div class="computation-flow">
                                <div class="computation-step output-step">
                                    <div class="formula">Y‚ÇÉ = <span class="layernorm-op">LayerNorm</span>(Y‚ÇÇ + ffn_out)</div>
                                    <div class="tensor-info">
                                        <div class="tensor-var">Y‚ÇÉ</div>
                                        <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="output-embedding">
                    <div class="sublayer-title">üì§ ËæìÂá∫ÊäïÂΩ±</div>
                    <div class="computation-flow">
                        <div class="computation-step output-step">
                            <div class="formula">logits = Y‚ÇÉ √ó W_out</div>
                            <div class="tensor-info">
                                <div class="tensor-var">Y‚ÇÉ</div>
                                <div class="tensor-shape-info">[B, S_tgt, d_model]</div>
                                <div class="tensor-var">W_out</div>
                                <div class="tensor-shape-info">[d_model, V]</div>
                                <div class="tensor-var">logits</div>
                                <div class="tensor-shape-info">[B, S_tgt, V]</div>
                            </div>
                        </div>

                        <div class="arrow">‚Üì</div>

                        <div class="computation-step output-step">
                            <div class="formula">probs = <span class="softmax-op">Softmax</span>(logits)</div>
                            <div class="tensor-info">
                                <div class="tensor-var">probs</div>
                                <div class="tensor-shape-info">[B, S_tgt, V]</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="note-box">
            <h4>üîç ÂÖ≥ÈîÆËÆ°ÁÆóÂÖ¨ÂºèËØ¶Ëß£</h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                <div>
                    <h5>üéØ Ê≥®ÊÑèÂäõÊú∫Âà∂Ê†∏ÂøÉÂÖ¨Âºè:</h5>
                    <div class="formula">Attention(Q,K,V) = Softmax(QK^T/‚àöd_k)V</div>
                    <ul style="font-size: 0.9em; margin-top: 10px;">
                        <li>Q: Êü•ËØ¢Áü©Èòµ [B, h, S_q, d_k]</li>
                        <li>K: ÈîÆÁü©Èòµ [B, h, S_k, d_k]</li>
                        <li>V: ÂÄºÁü©Èòµ [B, h, S_v, d_k]</li>
                        <li>‚àöd_k: Áº©ÊîæÂõ†Â≠êÔºåÈò≤Ê≠¢softmaxÈ•±Âíå</li>
                    </ul>
                </div>
                <div>
                    <h5>üîÑ Â§öÂ§¥Ê≥®ÊÑèÂäõ:</h5>
                    <div class="formula">MultiHead(Q,K,V) = Concat(head‚ÇÅ,...,head_h)W^O</div>
                    <div class="formula">head_i = Attention(QW^Q_i, KW^K_i, VW^V_i)</div>
                    <ul style="font-size: 0.9em; margin-top: 10px;">
                        <li>h = 8 ‰∏™Âπ∂Ë°åÁöÑÊ≥®ÊÑèÂäõÂ§¥</li>
                        <li>ÊØè‰∏™Â§¥Â§ÑÁêÜ d_k = d_model/h = 64 Áª¥</li>
                        <li>ÊúÄÂêéÊãºÊé•Âπ∂ÊäïÂΩ±Âõû d_model Áª¥</li>
                    </ul>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                <div>
                    <h5>üß† ‰ΩçÁΩÆÂâçÈ¶àÁΩëÁªú:</h5>
                    <div class="formula">FFN(x) = max(0, xW‚ÇÅ + b‚ÇÅ)W‚ÇÇ + b‚ÇÇ</div>
                    <ul style="font-size: 0.9em; margin-top: 10px;">
                        <li>Á¨¨‰∏ÄÂ±Ç: [d_model] ‚Üí [d_ff] (2048Áª¥)</li>
                        <li>ReLUÊøÄÊ¥ªÂáΩÊï∞</li>
                        <li>Á¨¨‰∫åÂ±Ç: [d_ff] ‚Üí [d_model]</li>
                    </ul>
                </div>
                <div>
                    <h5>üìè Â±ÇÂΩí‰∏ÄÂåñ:</h5>
                    <div class="formula">LayerNorm(x) = Œ≥ √ó (x-Œº)/œÉ + Œ≤</div>
                    <ul style="font-size: 0.9em; margin-top: 10px;">
                        <li>Œº: ËæìÂÖ•ÁöÑÂùáÂÄº</li>
                        <li>œÉ: ËæìÂÖ•ÁöÑÊ†áÂáÜÂ∑Æ</li>
                        <li>Œ≥,Œ≤: ÂèØÂ≠¶‰π†ÁöÑÁº©ÊîæÂíåÂÅèÁßªÂèÇÊï∞</li>
                        <li>ÂΩí‰∏ÄÂåñÂú®ÊúÄÂêé‰∏Ä‰∏™Áª¥Â∫¶(d_model)‰∏äËøõË°å</li>
                    </ul>
                </div>
            </div>

            <div style="margin-top: 15px;">
                <h5>üé≠ Êé©Á†ÅÊú∫Âà∂:</h5>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                    <div>
                        <strong>ÁºñÁ†ÅÂô®Ëá™Ê≥®ÊÑèÂäõ:</strong>
                        <div class="formula">mask = None (ÂÖ®ËøûÊé•)</div>
                    </div>
                    <div>
                        <strong>Ëß£Á†ÅÂô®Ëá™Ê≥®ÊÑèÂäõ:</strong>
                        <div class="formula">mask[i,j] = 0 if j > i (‰∏ã‰∏âËßí)</div>
                    </div>
                    <div>
                        <strong>‰∫§ÂèâÊ≥®ÊÑèÂäõ:</strong>
                        <div class="formula">mask = padding_mask (ÂèØÈÄâ)</div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 15px;">
                <h5>üìä ÂÖ≥ÈîÆÊäÄÊúØÁÇπ:</h5>
                <ul style="font-size: 0.9em; columns: 2; column-gap: 20px;">
                    <li><strong>ÊùÉÈáçÂÖ±‰∫´:</strong> ËæìÂá∫ÂµåÂÖ•Â±Ç‰∏éËæìÂá∫ÊäïÂΩ±Â±ÇÂÖ±‰∫´ÊùÉÈáç W_out = E^T</li>
                    <li><strong>ËØçÂµåÂÖ•Áº©Êîæ:</strong> ÂµåÂÖ•ÂêëÈáè‰πò‰ª•‚àöd_model ÊèêÂçáËÆ≠ÁªÉÁ®≥ÂÆöÊÄß</li>
                    <li><strong>ÊÆãÂ∑ÆËøûÊé•:</strong> ÊØè‰∏™Â≠êÂ±ÇÈÉΩÊúâ x + SubLayer(x) ÁöÑÊÆãÂ∑ÆËøûÊé•</li>
                    <li><strong>Dropout:</strong> Ê≥®ÊÑèÂäõÊùÉÈáç„ÄÅÂâçÈ¶àÁΩëÁªú„ÄÅÂµåÂÖ•Â±ÇÈÉΩÂ∫îÁî®dropout</li>
                    <li><strong>‰ΩçÁΩÆÁºñÁ†Å:</strong> ‰ΩøÁî®Âõ∫ÂÆöÁöÑÊ≠£Âº¶‰ΩôÂº¶ÂáΩÊï∞ÁºñÁ†Å‰ΩçÁΩÆ‰ø°ÊÅØ</li>
                    <li><strong>Â≠¶‰π†ÁéáË∞ÉÂ∫¶:</strong> ËÆ∫Êñá‰ΩøÁî®ÁâπÊÆäÁöÑwarmupÂ≠¶‰π†ÁéáË∞ÉÂ∫¶Á≠ñÁï•</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>